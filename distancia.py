import pandas as pd
from geopy.distance import great_circle


unis_br = {
    "br_1": (-23.5587, -46.7319),
    "br_2": (-30.0335, -51.2177),
    "br_3": (-22.8571, -43.2338),
    "br_4": (-19.8691, -43.9664),
    "br_5": (-27.6011, -48.5201),
    "br_6": (-22.8238, -47.0668),
    "br_7": (-15.7634, -47.8722),
    "br_8": (-23.5505, -46.6333),
    "br_9": (-25.4495, -49.2334),
    "br_10": (-8.0543, -34.9515),
    "br_11": (-13.0023, -38.5132),
    "br_12": (-22.8022, -45.1906),
    "br_13": (-22.9035, -43.1325),
    "br_14": (-3.7458, -38.5746),
    "br_15": (-5.8390, -35.2010),
    "br_16": (-22.0026, -47.9320),
    "br_17": (-30.0577, -51.1742),
    "br_18": (-22.9139, -43.2291),
    "br_19": (-20.7618, -42.8622),
    "br_20": (-21.2319, -44.9782),
    "br_21": (-29.7198, -53.7149),
    "br_22": (-22.9765, -43.2323),
    "br_23": (-1.4748, -48.4522),
    "br_24": (-16.6033, -49.2155),
    "br_25": (-31.7042, -52.3941),
    "br_26": (-23.5355, -46.6791),
    "br_27": (-23.4077, -51.9338),
    "br_28": (-23.5982, -46.6388),
    "br_29": (-7.1384, -34.8436),
    "br_30": (-22.8747, -43.2453),
    "br_31": (-18.9186, -48.2578),
    "br_32": (-23.3255, -51.1925),
    "br_33": (-20.2766, -40.3037),
    "br_34": (-29.7946, -51.1557),
    "br_35": (-21.7758, -43.3705),
    "br_36": (-22.7637, -43.6870),
    "br_37": (-8.0163, -34.9508),
    "br_38": (-25.4497, -49.2285),
    "br_39": (-32.0772, -52.1642),
    "br_40": (-27.5898, -48.5119),
    "br_41": (-19.9227, -43.9845),
    "br_42": (-3.8058, -38.5372),
    "br_43": (-22.9298, -43.1791),
    "br_44": (-21.7766, -41.3117),
    "br_45": (-20.3846, -43.5039),
    "br_46": (-23.6437, -46.5284),
    "br_47": (-26.9187, -48.6558),
    "br_48": (-25.4431, -49.2679),
    "br_49": (-2.9719, -59.9880),
    "br_50": (-15.5684, -56.0710),
    "br_51": (-23.1994, -45.8870),
    "br_52": (-9.6385, -35.7485),
    "br_53": (-7.2072, -35.8821),
    "br_54": (-24.9549, -53.4682),
    "br_55": (-23.2081, -45.8755),
    "br_56": (-23.5654, -46.6664),
    "br_57": (-3.0906, -59.9798),
    "br_58": (-25.0934, -50.1583),
    "br_59": (-10.9859, -37.0731),
    "br_60": (-20.5057, -54.5828),
    "br_61": (-14.7963, -39.1728),
    "br_62": (-10.9859, -37.0731),
    "br_63": (-2.5574, -44.3045),
    "br_64": (-22.9083, -43.1794),
    "br_65": (-22.2858, -54.7937),
    "br_66": (-12.1584, -38.9837),
    "br_67": (-28.2721, -52.4172),
    "br_68": (-20.5057, -54.5828),
    "br_69": (-22.4137, -45.4526),
    "br_70": (-23.5165, -46.6263),
    "br_71": (-15.8643, -48.0268),
    "br_72": (-29.1678, -51.1789),
    "br_73": (-22.9519, -43.2105),
    "br_74": (-26.9084, -49.0763),
    "br_75": (-8.0565, -34.9113),
    "br_76": (-22.8984, -47.0514),
    "br_77": (-7.1384, -34.8436),
    "br_78": (-29.6842, -52.4336),
    "br_79": (-12.9845, -38.4877),
    "br_80": (-10.9086, -37.0645),
    "br_81": (-23.6825, -46.5956),
    "br_82": (-7.2072, -35.8821),
    "br_83": (-14.8633, -40.8525),
    "br_84": (-21.1293, -44.2582),
    "br_85": (-22.9068, -43.1729),
    "br_86": (-29.9576, -51.1685),
    "br_87": (-12.6481, -38.9734),
    "br_88": (-5.5269, -37.3364),
    "br_89": (-22.7303, -47.3387),
    "br_90": (-22.8984, -43.2201),
    "br_91": (-30.0381, -51.2185),
    "br_92": (-31.7656, -52.3400),
    "br_93": (-22.3418, -46.9427),
    "br_94": (-3.7441, -38.4834),
    "br_95": (-5.0569, -42.8228),
    "br_96": (-25.1052, -51.4883),
    "br_97": (-21.4922, -45.9287),
    "br_98": (-22.9122, -43.2052),
    "br_99": (-3.0886, -59.9722),
}

# EX (campus principal)
unis_estrangeiras = {
    "ex_1": (41.1579, -8.6291),
    "ex_2": (40.2110, -8.4293),
    "ex_3": (51.5074, -0.1278),
    "ex_4": (38.7223, -9.1393),
    "ex_5": (40.6329, -8.6595),
    "ex_6": (41.3851, 2.1734),
    "ex_7": (41.5503, -8.4200),
    "ex_8": (37.8715, -122.2730),
    "ex_9": (48.9500, 2.3500),
    "ex_10": (38.7533, -9.1557),
    "ex_11": (48.8471, 2.3855),
    "ex_12": (23.1136, -82.3666),
    "ex_13": (-34.6037, -58.3816),
    "ex_14": (48.8584, 2.3444),
    "ex_15": (-34.9011, -56.1645),
    "ex_16": (29.6516, -82.3248),
    "ex_17": (41.4895, 2.0955),
    "ex_18": (45.1885, 5.7245),
    "ex_19": (40.9688, -5.6639),
    "ex_20": (48.8452, 2.3458),
    "ex_21": (30.2672, -97.7431),
    "ex_22": (43.0766, -89.4125),
    "ex_23": (42.4440, -76.4818),
    "ex_24": (37.3891, -5.9845),
    "ex_25": (40.4168, -3.7038),
    "ex_26": (41.9028, 12.4964),
    "ex_27": (43.6108, 3.8767),
    "ex_28": (51.4988, -0.1749),
    "ex_29": (42.8805, -8.5457),
    "ex_30": (40.5478, -3.6888),
    "ex_31": (30.6186, -96.3365),
    "ex_32": (48.8284, 2.3601),
    "ex_33": (23.1136, -82.3666),
    "ex_34": (48.1486, 11.5684),
    "ex_35": (41.3879, 2.1121),
    "ex_36": (45.4064, 11.8768),
    "ex_37": (40.1020, -88.2272),
    "ex_38": (51.7548, -1.2544),
    "ex_39": (53.3813, -1.4815),
    "ex_40": (48.8454, 2.3275),
    "ex_41": (20.0169, -75.8291),
    "ex_42": (49.2606, -123.2460),
    "ex_43": (56.1567, 10.2108),
    "ex_44": (37.1773, -3.5986),
    "ex_45": (51.0504, 13.7373),
    "ex_46": (53.3438, -6.2546),
    "ex_47": (48.8584, 2.3444),
    "ex_48": (41.6561, -0.8773),
    "ex_49": (51.9851, 5.6639),
    "ex_50": (-27.4975, 153.0137),
    "ex_51": (40.4168, -3.7038),
    "ex_52": (51.8727, 0.9501),
    "ex_53": (44.4648, 11.3426),
    "ex_54": (52.5186, 13.3932),
    "ex_55": (42.2780, -83.7382),
    "ex_56": (33.9547, -83.3773),
    "ex_57": (46.8139, -71.2082),
    "ex_58": (45.5017, -73.5673),
    "ex_59": (48.8998, 2.2289),
    "ex_60": (42.7015, -84.4822),
    "ex_61": (51.5345, 9.9356),
    "ex_62": (42.3770, -71.1167),
    "ex_63": (41.8268, -71.4025),
    "ex_64": (38.3498, -0.4907),
    "ex_65": (43.6629, -79.3957),
    "ex_66": (42.3505, -71.1054),
    "ex_67": (53.5232, -113.5263),
    "ex_68": (48.8482, 2.3567),
    "ex_69": (51.0543, 3.7174),
    "ex_70": (39.1973, -96.5852),
    "ex_71": (39.3289, -76.6205),
    "ex_72": (43.5323, -80.2267),
    "ex_73": (45.5017, -73.5673),
    "ex_74": (48.8566, 2.3522),
    "ex_75": (52.5186, 13.3932),
    "ex_76": (40.7128, -74.0060),
    "ex_77": (14.9167, -23.5167),
    "ex_78": (45.0703, 7.6869),
    "ex_79": (45.4642, 9.1900),
    "ex_80": (46.7813, -71.2872),
    "ex_81": (45.7825, 4.8725),
    "ex_82": (40.3225, -7.5057),
    "ex_83": (38.7167, -9.1333),
    "ex_84": (40.4531, -3.7268),
    "ex_85": (52.2053, 0.1218),
    "ex_86": (42.2333, -8.7167),
    "ex_87": (41.4542, -7.7332),
    "ex_88": (48.5734, 7.7521),
    "ex_89": (-34.6037, -58.3816),
    "ex_90": (54.3439, 10.1348),
    "ex_91": (51.4545, -0.9781),
    "ex_92": (53.4808, -2.2426),
    "ex_93": (22.4069, -79.9647),
    "ex_94": (41.7427, -111.8083),
    "ex_95": (-33.4489, -70.6693),
    "ex_96": (50.7351, -3.5342),
    "ex_97": (53.8008, -1.5491),
    "ex_98": (38.0364, -84.5037),
    "ex_99": (43.6047, 1.4442),
}

# --- 2. Lógica para gerar a matriz ---

# Pega os nomes das universidades para usar como rótulos na matriz
nomes_br = list(unis_br.keys())
nomes_estrangeiras = list(unis_estrangeiras.keys())

# Cria um DataFrame vazio com os nomes corretos nas linhas e colunas
matriz_distancias = pd.DataFrame(index=nomes_br, columns=nomes_estrangeiras)

# Itera sobre cada universidade brasileira (linhas)
for nome_br, coords_br in unis_br.items():
    # Itera sobre cada universidade estrangeira (colunas)
    for nome_estrangeira, coords_estrangeira in unis_estrangeiras.items():
        # Calcula a distância usando a fórmula great_circle (Haversine)
        # O resultado é dado em quilômetros por padrão
        distancia = great_circle(coords_br, coords_estrangeira).kilometers

        # Preenche a célula correspondente na matriz com a distância calculada
        matriz_distancias.loc[nome_br, nome_estrangeira] = int(distancia)


# --- 3. Exibir o resultado ---

print("Matriz de Distâncias Geográficas (em quilômetros):")
print(matriz_distancias)

# Salva a matriz em um arquivo CSV
matriz_distancias.to_csv("./dados/matriz_distancias.csv")
print("\nMatriz salva na pasta dados em 'matriz_distancias.csv'")
